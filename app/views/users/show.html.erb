<% provide :title, @user.nick %>

<div class="row">
  <div class="col-md-3">
    <div class="user-profile-avatar">
      <%= user_avatar_tag @user, image: { class: 'img-responsive', size: 263 }, url: gravatar_url(@user.gravatar_email, size: 400) %>
    </div>

    <ul class="list-group">
      <% if can? :show_email, @user %>
        <li class="list-group-item">
          <%= icon_tag :'envelope-o', fixed: true %>
          <%= mail_to @user.email, nil, encode: :hex %>
        </li>
      <% end %>

      <% @user.urls.each do |network, url| %>
        <li class="list-group-item">
          <%= icon_tag network.icon, fixed: true %>
          <a href="<%= url[:original] %>"><%= url[:shown] %></a>
        </li>
      <% end %>
    </ul>
  </div>
  <div class="col-md-9">
    <h1 class="page-header">
      <%= @user.nick %>

      <% if can? :show_name, @user %>
        <small><%= @user.name %></small>
      <% end %>
    </h1>

    <% if can? :edit, @user %>
      <span class="pull-right">
        <%= link_to t('user.show.edit'), edit_user_registration_path %>
      </span>
    <% end %>

    <% unless @user.about.blank? %>
      <h4><%= t 'user.show.about' %></h4>

      <%= render_markdown @user.about %>
    <% end %>

    <div class="clearfix"></div>
  </div>
</div>


  <ul class="nav nav-tabs">
    <%= tab_link_tag_with_count t('user.tab.questions'), :questions, user_path(params.except(:page).merge tab: :questions), Question.by(current_user).size %>
    <%= tab_link_tag_with_count t('user.tab.answers'), :answers, user_path(params.except(:page).merge tab: :answers), Answer.by(current_user).size %>
    <%= tab_link_tag_with_count t('user.tab.favorites'), :favorites, user_path(params.except(:page).merge tab: :favorites), Favorite.by(current_user).size %>
  </ul>

  <div class="tab-content">

    <%= tab_content_tag :questions do %>
      <% if @questions.any? %>
        <ol class="list-unstyled user-profile-list">
          <% @questions.each do |question| %>
            <%= render 'users/question', question: question %>
          <% end %>
        </ol>
      <% else %>
        <div class="row">
          <div class="col-md-12">
            <div class="alert alert-warning">
              <%= t('user.show.no_questions_found') %>
            </div>
            <%= icon_link_to :plus, t('question.new.feature'), new_question_path, class: 'btn btn-success' %>
          </div>
        </div>
      <% end %>

      <div class="row">
        <div class="col-md-12">
          <%= paginate @questions, params: { tab: :questions }, data: { state: true } %>
        </div>
      </div>
    <% end %>

    <%= tab_content_tag :answers do %>
      <% if @answers.any? %>
        <ol class="list-unstyled user-profile-list">
          <% @answers.each do |answer| %>
            <%= render 'users/answer', answer: answer %>
          <% end %>
        </ol>
      <% else %>
        <div class="row">
          <div class="col-md-12">
            <div class="alert alert-warning">
              <%= t('user.show.no_answers_found') %>
            </div>
            <%= icon_link_to :comment, t('home.answer'), question_path(@random_question), class: 'btn btn-success', fixed: true %>
          </div>
        </div>
      <% end %>

      <div class="row">
        <div class="col-md-12">
          <%= paginate @answers, params: { tab: :answers }, data: { state: true } %>
        </div>
      </div>
    <% end %>

    <%= tab_content_tag :favorites do %>
      <% if @favorites.any? %>
        <ol class="list-unstyled user-profile-list">
          <% @favorites.each do |favorite| %>
            <%= render 'users/question', question: favorite %>
          <% end %>
        </ol>
      <% else %>
        <div class="row">
          <div class="col-md-12">
            <div class="alert alert-warning">
              <%= t('user.show.no_favorites_found') %>
            </div>
            <%= icon_link_to :plus, t('question.new.feature'), new_question_path, class: 'btn btn-success' %>
          </div>
        </div>
      <% end %>

      <div class="row">
        <div class="col-md-12">
          <%= paginate @favorites, params: { tab: :favorites }, data: { state: true } %>
        </div>
      </div>
    <% end %>
  </div>

